<!DOCTYPE html>
<html>
	<head>
		<style>
			canvas 
			{
				border:1px solid #d3d3d3;
				background-color: #42ff64;
			}
		</style>
	</head>
	
	<body onload="">
		<script>
		
			var wingoal = 500000;
			var dmgdiff = 0;
			
			var bossex =1;
			var bossamp=1;
			var stdex=1;
			var stdamp=1;
			var stdadd = 0;
			var time=0;
			var boss_tempmod = 1;
			var stud_tempmod = 1;
			var booster_countdown = 0;
			var stun = 1;
			var bossphase = 1;
			var tincrement = 1;
		
			var healthbar = {
				canvas : document.createElement("canvas"),
				start : function() {
					this.canvas.width = 480;
					this.canvas.height = 50;
					this.context = this.canvas.getContext("2d");
					document.body.insertBefore(this.canvas, document.body.childNodes[0]);
					bosshp = new component(480,50,"red",-240,0);
				}
				
			}
			
			healthbar.start();
			
			function component(width, height, color, x, y, type) 
			{
				this.type = type;
				this.score = 0;
				this.width = 480;
				this.height = 50;
				this.speedX = 0;
				this.speedY = 0;    
				this.x = x;
				this.y = y;
				this.update = function() {
					ctx = healthbar.context;
					if (this.type == "text") {
						ctx.font = this.width + " " + this.height;
						ctx.fillStyle = color;
						ctx.fillText(this.text, this.x, this.y);
					} else {
						this.x = gethpx();
						ctx.fillStyle = "#42ff64";
						ctx.fillRect(0,0,480,50);
						ctx.fillStyle = color;
						ctx.fillRect(0, 0, this.x, this.height);
						console.log(this.width);
					}
    
				}
			}
			
			bosshp.update();
			
			function bossdmg(damage)
			{
				dmgdiff -= damage;
				bosshp.update();
				console.log(bosshp.x);
			}
			
			function studentdmg(damage)
			{
				dmgdiff += damage;
				bosshp.update();
				console.log(bosshp.x);
			}
			
			function gethpx()
			{
				var x = 480*(dmgdiff+wingoal)/(wingoal*2);
				return x;
			}
			
			
			
			
			function getdpss()
			{
				return (100+stdex)*(1+0.5*(1.2*Math.log(Math.E+(time/50))))*(1.2*Math.log(Math.E+(time/50)))*(stdamp)+(stdadd);
			}
			
			function getdpsb1()
			{
				return (150+bossex)*(1+0.5*(1*Math.log(Math.E+(time/50)))*(1*Math.log(Math.E+(time/50)))*Math.log(400/getbossperc()))*(bossamp);
			}
			
			function getdpsb2()
			{
				return (275+bossex)*(1+0.5*(1.2*Math.log(Math.E+(time/100)))*(1.2*Math.log(Math.E+(time/100)))*Math.log(400/getbossperc()))*(bossamp);
			}
			
			
			function damagetoboss()
			{
				dmgdiff -= getdpss()*0.1;
			}
			
			function damagetostd()
			{
				if(bossphase==1)
					dmgdiff+=(getdpsb1()/10);
				else
					dmgdiff+=(getdpsb2()/10);
			}
			
			
			
			function timer()
			{
				time+=tincrement;
			}
			
			function stun_boss(seconds)
			{
				stun = seconds;
				stundur = setInterval(function(){stun_countdown();},1000);
				
			}
			
			function stun_countdown()
			{
				stun-=1;
				if(stun==0)
				{
					clearInterval(stundur);;
				}
			}
			
			function getbossperc()
			{
				return (500000+dmgdiff)/10000;
			}
			setInterval(function(){console.log(dmgdiff)},100);
			setInterval(function(){console.log("Boss dps ="+getdpsb1())},100);
			setInterval(function(){console.log("Student dps ="+getdpss())},100);
			setInterval(function(){timer();},1000);
			setInterval(function(){damagetoboss()},100);
			setInterval(function(){damagetostd()},100);
			setInterval(function(){bosshp.update()},100);
			
			
		</script>
		</br>
		<button onclick="bossdmg(10)">DAMAGE BOSS 10</button>
		<button onclick="studentdmg(10)">DAMAGE STUDENTS 10</button>
		
		</br>
		<button onclick="bossdmg(50)">DAMAGE BOSS 50</button>
		<button onclick="studentdmg(50)">DAMAGE STUDENTS 50</button>
	</body>
	
	
</html>
